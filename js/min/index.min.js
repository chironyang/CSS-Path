var coord=Coord("svg"),$coord=$("#svg"),$pathlist=$("#pathlist"),$exportCss=$("#exportCss"),$coordOption=$("#coord-option");$coordPathOption=$("#coord-path-option"),coord.onCssChange=function(t){$exportCss.val(t)},function(){function t(){$coordPathOption.removeClass("active")}function o(t){$coordPathOption.addClass("active");var o,i;for(var e in t)o=$("[name="+e+"]"),i=o.attr("type"),"checkbox"==i&&t[e]instanceof Array?o.each(function(){t[e].indexOf(this.value)>-1&&(this.checked=!0)}):"checkbox"==i&&"boolean"==typeof t[e]?o.prop("checked",t[e]):"radio"==i?o.filter("[value="+t[e]+"]").prop("checked",!0):"image"==i?o.prop("src",t[e].src):o.val(t[e]);var a=n[t.timingFunction],c={x0:a&&a[0]||t.motion_p0x,y0:a&&a[1]||t.motion_p0y,x1:a&&a[2]||t.motion_p1x,y1:a&&a[3]||t.motion_p1y};changeBzPoint(c),changeBz(c)}var n={linear:[0,0,1,1],ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]};$("#addpath").on("click",function(){var t=new coord.path;return coord.setCurrentPath(t),o(coord.currentPath.option),$(this).parent().siblings().removeClass("active"),$(this).parent().before('<li class="active" path-id="'+t.id+'"><img/><span class="name">'+t.option.className+'</span><span class="remove">X</span></li>'),!1}),$("#pathlist").on("click","li",function(){var t=$(this).attr("path-id");t&&($(this).addClass("active").siblings().removeClass("active"),coord.setCurrentPath(t),o(coord.currentPath.option))}).on("click",".remove",function(){var o=$(this).parent().attr("path-id");return coord.removePath(o),$(this).parent().remove(),t(),!1})}(),function(){function t(t){var o=t.target,n=o.name,i=o.value;if("checkbox"==o.type&&(i=o.checked),n){"standard"==n&&(i=Array.prototype.map.call($("input[name=standard]:checked"),function(t){return t.value}));var e={};e[n]=i,coord.currentPath.setOption(e),coord.currentPath.draw()}}$(".tab").on("click","span",function(){var t=$(this);if(!t.hasClass("active")){var o=t.attr("target");t.addClass("active").siblings().removeClass("active"),$(".tab-content[frame="+o+"]").addClass("active").siblings().removeClass("active")}}),$coordPathOption.on("change","[type=text],[type=number],:radio,textarea",t),$coordPathOption.on("click",":checkbox",t)}(),function(){var t=$("#imgInput"),o=$("#imgSrc");$("#imgBtn").on("click",function(){t.click()}),o.on("load",function(){coord.currentPath.setImage(this.src,this.naturalWidth,this.naturalHeight),coord.currentPath.setOption({image:{src:this.src,width:this.naturalWidth,height:this.naturalHeight}})}),t.on("change",function(){var t=new FileReader;t.onloadend=function(){o.prop("src",t.result)},t.readAsDataURL(this.files[0])})}(),function(){var t,o,n,i,e=$("#timingFunction"),a=($("#motionWrap"),$("#motionPoint0")),c=$("#motionPoint1"),r=$("#motionBox"),s=($("#motionSvg"),$("#motionP0x")),u=$("#motionP0y"),h=$("#motionP1x"),l=$("#motionP1y"),d=$("#motionPath"),p=$("#motionLine1"),v=$("#motionLine2"),m=null,f=200,x={x0:0,y0:0,x1:1,y1:1};e.on("change",function(){if(coord.currentPath.setOption({timingFunction:this.value}),"cubic-bezier"===this.value){var t=coord.currentPath.option;x={x0:t.motion_p0x,y0:t.motion_p0y,x1:t.motion_p1x,y1:t.motion_p1y}}else{var t=$(this).find("option:selected").attr("p").split(",");x={x0:t[0],y0:t[1],x1:t[2],y1:t[3]}}changeBz(x),changeBzPoint(x),s.val(x.x0),u.val(x.y0),h.val(x.x1),l.val(x.y1),coord.currentPath.draw()}),r.on("mousedown",".motion-point",function(t){n=t.offsetX,i=t.offsetY,m=this,$(this).addClass("active"),e.val("cubic-bezier"),coord.currentPath.setOption({timingFunction:"cubic-bezier"})}),r.on("mousemove",function(e){return m?(t=e.offsetX,o=e.offsetY,e.target==this&&(t-=60,o-=40),e.target==m&&(t+=e.target.offsetLeft+n,o+=e.target.offsetTop+i),t=0>t?0:t>f?f:t,o=0>o?0:o>f?f:o,m==a[0]?(x.x0=(t/f).toFixed(2),x.y0=(o/f).toFixed(2),s.val(x.x0),u.val(x.y0),coord.currentPath.setOption({motion_p0x:x.x0,motion_p0y:x.y0})):m==c[0]&&(x.x1=(t/f).toFixed(2),x.y1=(o/f).toFixed(2),h.val(x.x1),l.val(x.y1),coord.currentPath.setOption({motion_p1x:x.x1,motion_p1y:x.y1})),m.style.left=t+"px",m.style.top=o+"px",changeBz(x),coord.currentPath.draw(),!1):void 0}),s.on("change",function(){x.x0=this.value,a.css("left",this.value*f),coord.currentPath.setOption({timingFunction:"cubic-bezier",motion_p0x:x.x0}),changeBz(x),e.val("cubic-bezier"),coord.currentPath.draw()}),u.on("change",function(){x.y0=this.value,a.css("top",this.value*f),coord.currentPath.setOption({timingFunction:"cubic-bezier",motion_p0y:x.y0}),changeBz(x),e.val("cubic-bezier"),coord.currentPath.draw()}),h.on("change",function(){x.x1=this.value,c.css("left",this.value*f),coord.currentPath.setOption({timingFunction:"cubic-bezier",motion_p1x:x.x1}),changeBz(x),e.val("cubic-bezier"),coord.currentPath.draw()}),l.on("change",function(){x.y1=this.value,c.css("top",this.value*f),coord.currentPath.setOption({timingFunction:"cubic-bezier",motion_p1y:x.y1}),changeBz(x),e.val("cubic-bezier"),coord.currentPath.draw()}),$(document).on("mouseup",function(){$(m).removeClass("active"),m=null}),window.changeBzPoint=function(t){a.css("left",t.x0*f),a.css("top",t.y0*f),c.css("left",t.x1*f),c.css("top",t.y1*f)},window.changeBz=function(t){x=t,d.attr("d","M0 0C"+[t.x0*f,t.y0*f].join(" ")+","+[t.x1*f,t.y1*f].join(" ")+","+[f,f].join(" ")),p.attr({x1:0,y1:0,x2:t.x0*f,y2:t.y0*f}),v.attr({x1:t.x1*f,y1:t.y1*f,x2:f,y2:f})}}(),function(){var t=$("#FORInput"),o=$("#FORSrc"),n=$("#forWidth"),i=$("#forHeight");o.on("load",function(){$coord.css("backgroundImage","url("+this.src+")"),n.val(this.naturalWidth),i.val(this.naturalHeight),$coord.css("background-size",[w+"px",h+"px"].join(" "))}),$("#FORBtn").on("click",function(){t.click()}),n.on("change",function(){if(this.value){var t=this.value,n=i.val()*this.value/o.prop("naturalWidth");i.val(n),$coord.css("background-size",[t+"px",n+"px"].join(" "))}}),i.on("change",function(){if(this.value){var t=this.value,i=n.val()*this.value/o.prop("naturalWidth");n.val(t),$coord.css("background-size",[i+"px",t+"px"].join(" "))}}),t.on("change",function(){var t=new FileReader;t.onloadend=function(){o.prop("src",t.result)},t.readAsDataURL(this.files[0])})}(),function(){$(".coord-control").on("click","span",function(){var t=this.className.match(/point|line|move|remove/),o=t&&t[0];o&&(document.body.className.search(new RegExp("coord-mode-"+o))>-1&&(o=""),coord.setState(o))})}();